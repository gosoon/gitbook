#### 进程切换与线程切换的区别：

1、进程是操作系统资源分配的基本单位，进程创建要分配内存等；

2、进程切换涉及虚拟内存的切换；



#### 进程切换比线程切换慢的原因：

（需要了解创建一个进程都需要分配哪些资源，进程地址空间）

1、进程之间的上下文切换最大的问题在于内存地址空间的切换会导致缓存失效（例如cpu中用于缓存虚拟地址与物理地址之间转换的 TLB 表）。还有些进程可能用到的 page cache 失效等问题；

2、进程切换涉及虚拟内存的切换，虚拟内存（即页表）切换比较耗时，切换后 TLB 会失效，参考（go 语音底层知识）

TLB（页表缓存）缓存虚拟地址和其映射的物理地址，否则只能一级一级查页表，64位系统一般都是多级页表。



#### 线程间到底共享了哪些进程资源：

1、线程运行的本质就是函数运行，函数运行时信息是保存在栈帧中的，因此每个线程都有自己独立的、私有的栈区。

2、进程地址空间中除函数栈相关的一些数据外（线程本地存储、函数调用栈（栈区、栈指针、程序计数器、函数运行时需要用的一些寄存器）等）其他的都可以共享；

3、线程所有的信息被称为线程上下文；

参考：https://zhuanlan.zhihu.com/p/352707156



线程共享进程地址空间中除线程上下文信息中的所有内容
